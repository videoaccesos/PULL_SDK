<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>pyzkaccess.device_data.model API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pyzkaccess.device_data.model</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">__all__ = [
    &#39;models_registry&#39;,
    &#39;Field&#39;,
    &#39;ModelMeta&#39;,
    &#39;Model&#39;
]

from enum import Enum
from typing import Mapping, MutableMapping, Callable, Optional, Type, TypeVar, Any

models_registry = {}  # type: MutableMapping[str, Type[Model]]


FieldDataT = TypeVar(&#39;FieldDataT&#39;)


class Field:
    &#34;&#34;&#34;This class is used to define a field in Model. The property
    it assignes to will be used to access to an appropriate table field.
    In other words it provides object access to that field.

    Every field in device tables stores as a string, but some of
    them have a certain data format which could be represented
    with python types. Also some of them may have value restrictions.
    All of these parameters may be specified in Field definition as
    data type, convertion and validation callbacks. By default a
    field is treated as string with no restrictions.

    &#34;&#34;&#34;
    def __init__(self,
                 raw_name: str,
                 field_datatype: Type = str,
                 get_cb: Optional[Callable[[str], Any]] = None,
                 set_cb: Optional[Callable[[Any], Any]] = None,
                 validation_cb: Optional[Callable[[FieldDataT], bool]] = None):
        &#34;&#34;&#34;On getting a field value from Model record, the process is:
         1. Retrieve raw field value of `raw_name`. If nothing then
            just return None
         2. If `get_cb` is set then call it and use its result as value
         3. If value is not instance of `field_datatype` then try to
            cast it to this type
         4. Return value as field value

        On setting a field value in Model record, the process is:
         1. Check if value has `field_datatype` type, raise an error
            if not
         2. If `validation_cb` is set then call it, if result is false
            then raise an error
         3. Extract Enum value if value is Enum
         4. If `set_cb` is set then call it and use its result as value
         5. Write `str(value)` to raw field value of `raw_name`

        Args:
            raw_name (str): field name in device table which this field
                associated to
            field_datatype (Type): type of data of this field. `str` by
                default
            get_cb (Callable[[str], Any], optional): callback that is
                called on field get before a raw string value will be
                converted to `field_datatype`
            set_cb (Callable[[Any], Any], optional): callback
                that is called on field set after value will be checked
                against `field_datatype` and validated by
                `validation_cb`
            validation_cb (Callable[[FieldDataT], bool], optional): this
                is a callback that is called on field set after
                value will be checked against `field_datatype`. If
                returns false then validation will be failed

        &#34;&#34;&#34;
        self._raw_name = raw_name
        self._field_datatype = field_datatype
        self._get_cb = get_cb
        self._set_cb = set_cb
        self._validation_cb = validation_cb

    @property
    def raw_name(self) -&gt; str:
        &#34;&#34;&#34;Raw field name in device table which this field
        associated to
        &#34;&#34;&#34;
        return self._raw_name

    @property
    def field_datatype(self) -&gt; Type:
        &#34;&#34;&#34;Field data type&#34;&#34;&#34;
        return self._field_datatype

    def to_raw_value(self, value: Any) -&gt; str:
        &#34;&#34;&#34;Convert value of `field_datatype` to a raw string value.
        This function typically calls on field set.

        Checks incoming value against `field_datatype`, validates it
        using `validation_cb` (if any) and converts it using `set_cb`
        (if any).

        Args:
            value (Any): value of `field_datatype`

        Returns:
            str: raw value string representation

        &#34;&#34;&#34;
        if not isinstance(value, self._field_datatype):
            raise TypeError(
                &#39;Bad value type {}, must be {}&#39;.format(type(value), self._field_datatype)
            )

        if not(self._validation_cb is None or self._validation_cb(value)):
            raise ValueError(&#39;Value {} does not meet to field restrictions&#39;.format(value))

        if isinstance(value, Enum):
            value = value.value

        if self._set_cb is not None:
            value = self._set_cb(value)

        return str(value)

    def to_field_value(self, value: str) -&gt; FieldDataT:
        &#34;&#34;&#34;Convert raw string value to a value of `field_datatype`.
        This function typically calls on field get.

        Converts incoming value using `get_cb` (if any). If
        type of value after that is not an instance of `field_datatype`,
        then tries to cast value to `field_datatype` (if specified).

        Args:
            value (str): raw string representation

        Returns:
            value of `field_datatype`

        &#34;&#34;&#34;
        if self._get_cb is not None:
            value = self._get_cb(value)
        if not isinstance(value, self._field_datatype) and value is not None:
            value = self._field_datatype(value)

        return value

    def __hash__(self):
        return hash(self._raw_name)

    def __get__(self, instance, owner):
        if instance is None:
            return self

        value = instance._raw_data.get(self._raw_name)  # type: Optional[str]
        if value is not None:
            value = self.to_field_value(value)

        return value

    def __set__(self, instance, value):
        if instance is None:
            return

        if value is None:
            self.__delete__(instance)
            return

        raw_value = self.to_raw_value(value)
        instance._raw_data[self._raw_name] = raw_value  # noqa
        instance._dirty = True

    def __delete__(self, instance):
        if instance is None:
            return

        if self._raw_name in instance._raw_data:
            del instance._raw_data[self._raw_name]
            instance._dirty = True


class ModelMeta(type):
    def __new__(mcs, name, bases, attrs):
        attrs[&#39;_fields_mapping&#39;] = {}
        attrs.setdefault(&#39;__annotations__&#39;, {})  # python &gt;= 3.6
        for attr_name, attr in attrs.items():
            if isinstance(attr, Field):
                attrs[&#39;_fields_mapping&#39;][attr_name] = attr.raw_name
                # Set field doc and annotations to correct render field
                # in documentation
                attrs[attr_name].__doc__ = &#39;{}.{}&#39;.format(name, attr_name)
                attrs[&#39;__annotations__&#39;][attr_name] = attr.field_datatype

        klass = super(ModelMeta, mcs).__new__(mcs, name, bases, attrs)
        models_registry[name] = klass  # noqa
        return klass


class Model(metaclass=ModelMeta):
    &#34;&#34;&#34;Base class for models that represent device data tables.

    A concrete model contains device table name and field definitions.
    Also it provides interface to access to these fields in a concrete
    row and to manipulate that row.

    &#34;&#34;&#34;
    table_name = None
    &#34;&#34;&#34;Raw table name on device&#34;&#34;&#34;

    _fields_mapping = None

    def __init__(self, **fields):
        &#34;&#34;&#34;Accepts initial fields data in kwargs&#34;&#34;&#34;
        self._sdk = None
        self._dirty = True
        self._raw_data = {}  # type: Mapping[str, str]

        fm = self._fields_mapping
        if fields:
            unknown_fields = fields.keys() - fm.keys()
            if unknown_fields:
                raise TypeError(&#39;Unknown fields: {}&#39;.format(tuple(unknown_fields)))

            self._raw_data = {
                fm[field]: getattr(self.__class__, field).to_raw_value(fields.get(field))
                for field in fm.keys() &amp; fields.keys()
                if fields.get(field) is not None
            }

    @property
    def dict(self) -&gt; Mapping[str, FieldDataT]:
        return {field: getattr(self, field) for field in self._fields_mapping.keys()}

    @property
    def raw_data(self) -&gt; Mapping[str, str]:
        &#34;&#34;&#34;Return the raw data that we read from or write to a device&#34;&#34;&#34;
        return {field: self._raw_data.get(field, &#39;&#39;) for field in self._fields_mapping.values()}

    @classmethod
    def fields_mapping(cls) -&gt; Mapping[str, str]:
        &#34;&#34;&#34;Mapping between model fields and their raw fields&#34;&#34;&#34;
        return cls._fields_mapping

    def delete(self):
        &#34;&#34;&#34;Delete this record from a table&#34;&#34;&#34;
        if self._sdk is None:
            raise TypeError(&#39;Unable to delete a manually created data table record&#39;)

        gen = self._sdk.delete_device_data(self.table_name)
        gen.send(None)
        gen.send(self.raw_data)
        try:
            gen.send(None)
        except StopIteration:
            pass

        self._dirty = True

    def save(self):
        &#34;&#34;&#34;Save changes in this record&#34;&#34;&#34;
        if self._sdk is None:
            raise TypeError(&#39;Unable to save a manually created data table record&#39;)

        gen = self._sdk.set_device_data(self.table_name)
        gen.send(None)
        gen.send(self.raw_data)
        try:
            gen.send(None)
        except StopIteration:
            pass

        self._dirty = False

    def with_raw_data(self, raw_data: Mapping[str, str], dirty: bool = True) -&gt; &#39;Model&#39;:
        self._raw_data = raw_data
        self._dirty = dirty
        return self

    def with_sdk(self, sdk) -&gt; &#39;Model&#39;:
        self._sdk = sdk
        return self

    def with_zk(self, zk) -&gt; &#39;Model&#39;:
        &#34;&#34;&#34;Bind current object with ZKAccess connection

        Args:
            zk (ZKAccess): ZKAccess object

        Returns:
            Model: self

        &#34;&#34;&#34;
        self._sdk = zk.sdk
        return self

    def __eq__(self, other):
        if not isinstance(other, self.__class__):
            return False

        return self._raw_data == other._raw_data and self.table_name == other.table_name

    def __repr__(self):
        data = &#39;, &#39;.join(
            &#39;{}={}&#39;.format(f, self.raw_data.get(k))
            for f, k in sorted(self.fields_mapping().items())
        )
        return &#39;{}{}({})&#39;.format(&#39;*&#39; if self._dirty else &#39;&#39;, self.__class__.__name__, data)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pyzkaccess.device_data.model.Field"><code class="flex name class">
<span>class <span class="ident">Field</span></span>
<span>(</span><span>raw_name: str, field_datatype: Type = builtins.str, get_cb: Optional[Callable[[str], Any]] = None, set_cb: Optional[Callable[[Any], Any]] = None, validation_cb: Optional[Callable[[~FieldDataT], bool]] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>This class is used to define a field in Model. The property
it assignes to will be used to access to an appropriate table field.
In other words it provides object access to that field.</p>
<p>Every field in device tables stores as a string, but some of
them have a certain data format which could be represented
with python types. Also some of them may have value restrictions.
All of these parameters may be specified in Field definition as
data type, convertion and validation callbacks. By default a
field is treated as string with no restrictions.</p>
<p>On getting a field value from Model record, the process is:
1. Retrieve raw field value of <code>raw_name</code>. If nothing then
just return None
2. If <code>get_cb</code> is set then call it and use its result as value
3. If value is not instance of <code>field_datatype</code> then try to
cast it to this type
4. Return value as field value</p>
<p>On setting a field value in Model record, the process is:
1. Check if value has <code>field_datatype</code> type, raise an error
if not
2. If <code>validation_cb</code> is set then call it, if result is false
then raise an error
3. Extract Enum value if value is Enum
4. If <code>set_cb</code> is set then call it and use its result as value
5. Write <code>str(value)</code> to raw field value of <code>raw_name</code></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>raw_name</code></strong> :&ensp;<code>str</code></dt>
<dd>field name in device table which this field
associated to</dd>
<dt><strong><code>field_datatype</code></strong> :&ensp;<code>Type</code></dt>
<dd>type of data of this field. <code>str</code> by
default</dd>
<dt><strong><code>get_cb</code></strong> :&ensp;<code>Callable[[str], Any]</code>, optional</dt>
<dd>callback that is
called on field get before a raw string value will be
converted to <code>field_datatype</code></dd>
<dt><strong><code>set_cb</code></strong> :&ensp;<code>Callable[[Any], Any]</code>, optional</dt>
<dd>callback
that is called on field set after value will be checked
against <code>field_datatype</code> and validated by
<code>validation_cb</code></dd>
<dt><strong><code>validation_cb</code></strong> :&ensp;<code>Callable[[FieldDataT], bool]</code>, optional</dt>
<dd>this
is a callback that is called on field set after
value will be checked against <code>field_datatype</code>. If
returns false then validation will be failed</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Field:
    &#34;&#34;&#34;This class is used to define a field in Model. The property
    it assignes to will be used to access to an appropriate table field.
    In other words it provides object access to that field.

    Every field in device tables stores as a string, but some of
    them have a certain data format which could be represented
    with python types. Also some of them may have value restrictions.
    All of these parameters may be specified in Field definition as
    data type, convertion and validation callbacks. By default a
    field is treated as string with no restrictions.

    &#34;&#34;&#34;
    def __init__(self,
                 raw_name: str,
                 field_datatype: Type = str,
                 get_cb: Optional[Callable[[str], Any]] = None,
                 set_cb: Optional[Callable[[Any], Any]] = None,
                 validation_cb: Optional[Callable[[FieldDataT], bool]] = None):
        &#34;&#34;&#34;On getting a field value from Model record, the process is:
         1. Retrieve raw field value of `raw_name`. If nothing then
            just return None
         2. If `get_cb` is set then call it and use its result as value
         3. If value is not instance of `field_datatype` then try to
            cast it to this type
         4. Return value as field value

        On setting a field value in Model record, the process is:
         1. Check if value has `field_datatype` type, raise an error
            if not
         2. If `validation_cb` is set then call it, if result is false
            then raise an error
         3. Extract Enum value if value is Enum
         4. If `set_cb` is set then call it and use its result as value
         5. Write `str(value)` to raw field value of `raw_name`

        Args:
            raw_name (str): field name in device table which this field
                associated to
            field_datatype (Type): type of data of this field. `str` by
                default
            get_cb (Callable[[str], Any], optional): callback that is
                called on field get before a raw string value will be
                converted to `field_datatype`
            set_cb (Callable[[Any], Any], optional): callback
                that is called on field set after value will be checked
                against `field_datatype` and validated by
                `validation_cb`
            validation_cb (Callable[[FieldDataT], bool], optional): this
                is a callback that is called on field set after
                value will be checked against `field_datatype`. If
                returns false then validation will be failed

        &#34;&#34;&#34;
        self._raw_name = raw_name
        self._field_datatype = field_datatype
        self._get_cb = get_cb
        self._set_cb = set_cb
        self._validation_cb = validation_cb

    @property
    def raw_name(self) -&gt; str:
        &#34;&#34;&#34;Raw field name in device table which this field
        associated to
        &#34;&#34;&#34;
        return self._raw_name

    @property
    def field_datatype(self) -&gt; Type:
        &#34;&#34;&#34;Field data type&#34;&#34;&#34;
        return self._field_datatype

    def to_raw_value(self, value: Any) -&gt; str:
        &#34;&#34;&#34;Convert value of `field_datatype` to a raw string value.
        This function typically calls on field set.

        Checks incoming value against `field_datatype`, validates it
        using `validation_cb` (if any) and converts it using `set_cb`
        (if any).

        Args:
            value (Any): value of `field_datatype`

        Returns:
            str: raw value string representation

        &#34;&#34;&#34;
        if not isinstance(value, self._field_datatype):
            raise TypeError(
                &#39;Bad value type {}, must be {}&#39;.format(type(value), self._field_datatype)
            )

        if not(self._validation_cb is None or self._validation_cb(value)):
            raise ValueError(&#39;Value {} does not meet to field restrictions&#39;.format(value))

        if isinstance(value, Enum):
            value = value.value

        if self._set_cb is not None:
            value = self._set_cb(value)

        return str(value)

    def to_field_value(self, value: str) -&gt; FieldDataT:
        &#34;&#34;&#34;Convert raw string value to a value of `field_datatype`.
        This function typically calls on field get.

        Converts incoming value using `get_cb` (if any). If
        type of value after that is not an instance of `field_datatype`,
        then tries to cast value to `field_datatype` (if specified).

        Args:
            value (str): raw string representation

        Returns:
            value of `field_datatype`

        &#34;&#34;&#34;
        if self._get_cb is not None:
            value = self._get_cb(value)
        if not isinstance(value, self._field_datatype) and value is not None:
            value = self._field_datatype(value)

        return value

    def __hash__(self):
        return hash(self._raw_name)

    def __get__(self, instance, owner):
        if instance is None:
            return self

        value = instance._raw_data.get(self._raw_name)  # type: Optional[str]
        if value is not None:
            value = self.to_field_value(value)

        return value

    def __set__(self, instance, value):
        if instance is None:
            return

        if value is None:
            self.__delete__(instance)
            return

        raw_value = self.to_raw_value(value)
        instance._raw_data[self._raw_name] = raw_value  # noqa
        instance._dirty = True

    def __delete__(self, instance):
        if instance is None:
            return

        if self._raw_name in instance._raw_data:
            del instance._raw_data[self._raw_name]
            instance._dirty = True</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="pyzkaccess.device_data.model.Field.field_datatype"><code class="name">var <span class="ident">field_datatype</span> : Type</code></dt>
<dd>
<div class="desc"><p>Field data type</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def field_datatype(self) -&gt; Type:
    &#34;&#34;&#34;Field data type&#34;&#34;&#34;
    return self._field_datatype</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Field.raw_name"><code class="name">var <span class="ident">raw_name</span> : str</code></dt>
<dd>
<div class="desc"><p>Raw field name in device table which this field
associated to</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def raw_name(self) -&gt; str:
    &#34;&#34;&#34;Raw field name in device table which this field
    associated to
    &#34;&#34;&#34;
    return self._raw_name</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pyzkaccess.device_data.model.Field.to_field_value"><code class="name flex">
<span>def <span class="ident">to_field_value</span></span>(<span>self, value: str) ‑> ~FieldDataT</span>
</code></dt>
<dd>
<div class="desc"><p>Convert raw string value to a value of <code>field_datatype</code>.
This function typically calls on field get.</p>
<p>Converts incoming value using <code>get_cb</code> (if any). If
type of value after that is not an instance of <code>field_datatype</code>,
then tries to cast value to <code>field_datatype</code> (if specified).</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong> :&ensp;<code>str</code></dt>
<dd>raw string representation</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>value of <code>field_datatype</code></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_field_value(self, value: str) -&gt; FieldDataT:
    &#34;&#34;&#34;Convert raw string value to a value of `field_datatype`.
    This function typically calls on field get.

    Converts incoming value using `get_cb` (if any). If
    type of value after that is not an instance of `field_datatype`,
    then tries to cast value to `field_datatype` (if specified).

    Args:
        value (str): raw string representation

    Returns:
        value of `field_datatype`

    &#34;&#34;&#34;
    if self._get_cb is not None:
        value = self._get_cb(value)
    if not isinstance(value, self._field_datatype) and value is not None:
        value = self._field_datatype(value)

    return value</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Field.to_raw_value"><code class="name flex">
<span>def <span class="ident">to_raw_value</span></span>(<span>self, value: Any) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Convert value of <code>field_datatype</code> to a raw string value.
This function typically calls on field set.</p>
<p>Checks incoming value against <code>field_datatype</code>, validates it
using <code>validation_cb</code> (if any) and converts it using <code>set_cb</code>
(if any).</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong> :&ensp;<code>Any</code></dt>
<dd>value of <code>field_datatype</code></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>raw value string representation</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_raw_value(self, value: Any) -&gt; str:
    &#34;&#34;&#34;Convert value of `field_datatype` to a raw string value.
    This function typically calls on field set.

    Checks incoming value against `field_datatype`, validates it
    using `validation_cb` (if any) and converts it using `set_cb`
    (if any).

    Args:
        value (Any): value of `field_datatype`

    Returns:
        str: raw value string representation

    &#34;&#34;&#34;
    if not isinstance(value, self._field_datatype):
        raise TypeError(
            &#39;Bad value type {}, must be {}&#39;.format(type(value), self._field_datatype)
        )

    if not(self._validation_cb is None or self._validation_cb(value)):
        raise ValueError(&#39;Value {} does not meet to field restrictions&#39;.format(value))

    if isinstance(value, Enum):
        value = value.value

    if self._set_cb is not None:
        value = self._set_cb(value)

    return str(value)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pyzkaccess.device_data.model.Model"><code class="flex name class">
<span>class <span class="ident">Model</span></span>
<span>(</span><span>**fields)</span>
</code></dt>
<dd>
<div class="desc"><p>Base class for models that represent device data tables.</p>
<p>A concrete model contains device table name and field definitions.
Also it provides interface to access to these fields in a concrete
row and to manipulate that row.</p>
<p>Accepts initial fields data in kwargs</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Model(metaclass=ModelMeta):
    &#34;&#34;&#34;Base class for models that represent device data tables.

    A concrete model contains device table name and field definitions.
    Also it provides interface to access to these fields in a concrete
    row and to manipulate that row.

    &#34;&#34;&#34;
    table_name = None
    &#34;&#34;&#34;Raw table name on device&#34;&#34;&#34;

    _fields_mapping = None

    def __init__(self, **fields):
        &#34;&#34;&#34;Accepts initial fields data in kwargs&#34;&#34;&#34;
        self._sdk = None
        self._dirty = True
        self._raw_data = {}  # type: Mapping[str, str]

        fm = self._fields_mapping
        if fields:
            unknown_fields = fields.keys() - fm.keys()
            if unknown_fields:
                raise TypeError(&#39;Unknown fields: {}&#39;.format(tuple(unknown_fields)))

            self._raw_data = {
                fm[field]: getattr(self.__class__, field).to_raw_value(fields.get(field))
                for field in fm.keys() &amp; fields.keys()
                if fields.get(field) is not None
            }

    @property
    def dict(self) -&gt; Mapping[str, FieldDataT]:
        return {field: getattr(self, field) for field in self._fields_mapping.keys()}

    @property
    def raw_data(self) -&gt; Mapping[str, str]:
        &#34;&#34;&#34;Return the raw data that we read from or write to a device&#34;&#34;&#34;
        return {field: self._raw_data.get(field, &#39;&#39;) for field in self._fields_mapping.values()}

    @classmethod
    def fields_mapping(cls) -&gt; Mapping[str, str]:
        &#34;&#34;&#34;Mapping between model fields and their raw fields&#34;&#34;&#34;
        return cls._fields_mapping

    def delete(self):
        &#34;&#34;&#34;Delete this record from a table&#34;&#34;&#34;
        if self._sdk is None:
            raise TypeError(&#39;Unable to delete a manually created data table record&#39;)

        gen = self._sdk.delete_device_data(self.table_name)
        gen.send(None)
        gen.send(self.raw_data)
        try:
            gen.send(None)
        except StopIteration:
            pass

        self._dirty = True

    def save(self):
        &#34;&#34;&#34;Save changes in this record&#34;&#34;&#34;
        if self._sdk is None:
            raise TypeError(&#39;Unable to save a manually created data table record&#39;)

        gen = self._sdk.set_device_data(self.table_name)
        gen.send(None)
        gen.send(self.raw_data)
        try:
            gen.send(None)
        except StopIteration:
            pass

        self._dirty = False

    def with_raw_data(self, raw_data: Mapping[str, str], dirty: bool = True) -&gt; &#39;Model&#39;:
        self._raw_data = raw_data
        self._dirty = dirty
        return self

    def with_sdk(self, sdk) -&gt; &#39;Model&#39;:
        self._sdk = sdk
        return self

    def with_zk(self, zk) -&gt; &#39;Model&#39;:
        &#34;&#34;&#34;Bind current object with ZKAccess connection

        Args:
            zk (ZKAccess): ZKAccess object

        Returns:
            Model: self

        &#34;&#34;&#34;
        self._sdk = zk.sdk
        return self

    def __eq__(self, other):
        if not isinstance(other, self.__class__):
            return False

        return self._raw_data == other._raw_data and self.table_name == other.table_name

    def __repr__(self):
        data = &#39;, &#39;.join(
            &#39;{}={}&#39;.format(f, self.raw_data.get(k))
            for f, k in sorted(self.fields_mapping().items())
        )
        return &#39;{}{}({})&#39;.format(&#39;*&#39; if self._dirty else &#39;&#39;, self.__class__.__name__, data)</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="pyzkaccess.tables.FirstCard" href="../tables.html#pyzkaccess.tables.FirstCard">FirstCard</a></li>
<li><a title="pyzkaccess.tables.Holiday" href="../tables.html#pyzkaccess.tables.Holiday">Holiday</a></li>
<li><a title="pyzkaccess.tables.InOutFun" href="../tables.html#pyzkaccess.tables.InOutFun">InOutFun</a></li>
<li><a title="pyzkaccess.tables.MultiCard" href="../tables.html#pyzkaccess.tables.MultiCard">MultiCard</a></li>
<li><a title="pyzkaccess.tables.TemplateV10" href="../tables.html#pyzkaccess.tables.TemplateV10">TemplateV10</a></li>
<li><a title="pyzkaccess.tables.Timezone" href="../tables.html#pyzkaccess.tables.Timezone">Timezone</a></li>
<li><a title="pyzkaccess.tables.Transaction" href="../tables.html#pyzkaccess.tables.Transaction">Transaction</a></li>
<li><a title="pyzkaccess.tables.User" href="../tables.html#pyzkaccess.tables.User">User</a></li>
<li><a title="pyzkaccess.tables.UserAuthorize" href="../tables.html#pyzkaccess.tables.UserAuthorize">UserAuthorize</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pyzkaccess.device_data.model.Model.table_name"><code class="name">var <span class="ident">table_name</span></code></dt>
<dd>
<div class="desc"><p>Raw table name on device</p></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="pyzkaccess.device_data.model.Model.fields_mapping"><code class="name flex">
<span>def <span class="ident">fields_mapping</span></span>(<span>) ‑> Mapping[str, str]</span>
</code></dt>
<dd>
<div class="desc"><p>Mapping between model fields and their raw fields</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def fields_mapping(cls) -&gt; Mapping[str, str]:
    &#34;&#34;&#34;Mapping between model fields and their raw fields&#34;&#34;&#34;
    return cls._fields_mapping</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="pyzkaccess.device_data.model.Model.dict"><code class="name">var <span class="ident">dict</span> : Mapping[str, ~FieldDataT]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def dict(self) -&gt; Mapping[str, FieldDataT]:
    return {field: getattr(self, field) for field in self._fields_mapping.keys()}</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Model.raw_data"><code class="name">var <span class="ident">raw_data</span> : Mapping[str, str]</code></dt>
<dd>
<div class="desc"><p>Return the raw data that we read from or write to a device</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def raw_data(self) -&gt; Mapping[str, str]:
    &#34;&#34;&#34;Return the raw data that we read from or write to a device&#34;&#34;&#34;
    return {field: self._raw_data.get(field, &#39;&#39;) for field in self._fields_mapping.values()}</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pyzkaccess.device_data.model.Model.delete"><code class="name flex">
<span>def <span class="ident">delete</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Delete this record from a table</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete(self):
    &#34;&#34;&#34;Delete this record from a table&#34;&#34;&#34;
    if self._sdk is None:
        raise TypeError(&#39;Unable to delete a manually created data table record&#39;)

    gen = self._sdk.delete_device_data(self.table_name)
    gen.send(None)
    gen.send(self.raw_data)
    try:
        gen.send(None)
    except StopIteration:
        pass

    self._dirty = True</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Model.save"><code class="name flex">
<span>def <span class="ident">save</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Save changes in this record</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save(self):
    &#34;&#34;&#34;Save changes in this record&#34;&#34;&#34;
    if self._sdk is None:
        raise TypeError(&#39;Unable to save a manually created data table record&#39;)

    gen = self._sdk.set_device_data(self.table_name)
    gen.send(None)
    gen.send(self.raw_data)
    try:
        gen.send(None)
    except StopIteration:
        pass

    self._dirty = False</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Model.with_raw_data"><code class="name flex">
<span>def <span class="ident">with_raw_data</span></span>(<span>self, raw_data: Mapping[str, str], dirty: bool = True) ‑> <a title="pyzkaccess.device_data.model.Model" href="#pyzkaccess.device_data.model.Model">Model</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def with_raw_data(self, raw_data: Mapping[str, str], dirty: bool = True) -&gt; &#39;Model&#39;:
    self._raw_data = raw_data
    self._dirty = dirty
    return self</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Model.with_sdk"><code class="name flex">
<span>def <span class="ident">with_sdk</span></span>(<span>self, sdk) ‑> <a title="pyzkaccess.device_data.model.Model" href="#pyzkaccess.device_data.model.Model">Model</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def with_sdk(self, sdk) -&gt; &#39;Model&#39;:
    self._sdk = sdk
    return self</code></pre>
</details>
</dd>
<dt id="pyzkaccess.device_data.model.Model.with_zk"><code class="name flex">
<span>def <span class="ident">with_zk</span></span>(<span>self, zk) ‑> <a title="pyzkaccess.device_data.model.Model" href="#pyzkaccess.device_data.model.Model">Model</a></span>
</code></dt>
<dd>
<div class="desc"><p>Bind current object with ZKAccess connection</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>zk</code></strong> :&ensp;<code>ZKAccess</code></dt>
<dd>ZKAccess object</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="pyzkaccess.device_data.model.Model" href="#pyzkaccess.device_data.model.Model">Model</a></code></dt>
<dd>self</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def with_zk(self, zk) -&gt; &#39;Model&#39;:
    &#34;&#34;&#34;Bind current object with ZKAccess connection

    Args:
        zk (ZKAccess): ZKAccess object

    Returns:
        Model: self

    &#34;&#34;&#34;
    self._sdk = zk.sdk
    return self</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pyzkaccess.device_data.model.ModelMeta"><code class="flex name class">
<span>class <span class="ident">ModelMeta</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>type(object_or_name, bases, dict)
type(object) -&gt; the object's type
type(name, bases, dict) -&gt; a new type</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ModelMeta(type):
    def __new__(mcs, name, bases, attrs):
        attrs[&#39;_fields_mapping&#39;] = {}
        attrs.setdefault(&#39;__annotations__&#39;, {})  # python &gt;= 3.6
        for attr_name, attr in attrs.items():
            if isinstance(attr, Field):
                attrs[&#39;_fields_mapping&#39;][attr_name] = attr.raw_name
                # Set field doc and annotations to correct render field
                # in documentation
                attrs[attr_name].__doc__ = &#39;{}.{}&#39;.format(name, attr_name)
                attrs[&#39;__annotations__&#39;][attr_name] = attr.field_datatype

        klass = super(ModelMeta, mcs).__new__(mcs, name, bases, attrs)
        models_registry[name] = klass  # noqa
        return klass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>builtins.type</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="🔎 Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pyzkaccess.device_data" href="index.html">pyzkaccess.device_data</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pyzkaccess.device_data.model.Field" href="#pyzkaccess.device_data.model.Field">Field</a></code></h4>
<ul class="">
<li><code><a title="pyzkaccess.device_data.model.Field.field_datatype" href="#pyzkaccess.device_data.model.Field.field_datatype">field_datatype</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Field.raw_name" href="#pyzkaccess.device_data.model.Field.raw_name">raw_name</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Field.to_field_value" href="#pyzkaccess.device_data.model.Field.to_field_value">to_field_value</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Field.to_raw_value" href="#pyzkaccess.device_data.model.Field.to_raw_value">to_raw_value</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pyzkaccess.device_data.model.Model" href="#pyzkaccess.device_data.model.Model">Model</a></code></h4>
<ul class="two-column">
<li><code><a title="pyzkaccess.device_data.model.Model.delete" href="#pyzkaccess.device_data.model.Model.delete">delete</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.dict" href="#pyzkaccess.device_data.model.Model.dict">dict</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.fields_mapping" href="#pyzkaccess.device_data.model.Model.fields_mapping">fields_mapping</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.raw_data" href="#pyzkaccess.device_data.model.Model.raw_data">raw_data</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.save" href="#pyzkaccess.device_data.model.Model.save">save</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.table_name" href="#pyzkaccess.device_data.model.Model.table_name">table_name</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.with_raw_data" href="#pyzkaccess.device_data.model.Model.with_raw_data">with_raw_data</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.with_sdk" href="#pyzkaccess.device_data.model.Model.with_sdk">with_sdk</a></code></li>
<li><code><a title="pyzkaccess.device_data.model.Model.with_zk" href="#pyzkaccess.device_data.model.Model.with_zk">with_zk</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pyzkaccess.device_data.model.ModelMeta" href="#pyzkaccess.device_data.model.ModelMeta">ModelMeta</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>